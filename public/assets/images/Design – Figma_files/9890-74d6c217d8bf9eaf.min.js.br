"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="ba567ef6-a672-5445-b5c5-cb6951b031aa")}catch(e){}}();
(globalThis.webpackChunk_figma_web_bundler=globalThis.webpackChunk_figma_web_bundler||[]).push([[9890],{763554:(e,t,o)=>{o.d(t,{Do:()=>m,Du:()=>p,El:()=>E,JO:()=>h,Jx:()=>b,Lp:()=>v,Mc:()=>g,ON:()=>i,RW:()=>f,Rq:()=>d,Vr:()=>u,Vs:()=>C,Y:()=>l,YZ:()=>s,ZF:()=>w,h3:()=>y,hu:()=>_,jG:()=>c,kL:()=>a,qc:()=>r,qp:()=>I,se:()=>n,xn:()=>k});let a="post_to_feed_view--container--BiDZs",n="post_to_feed_view--noContentContainer--VE8Tm post_to_feed_view--container--BiDZs text--fontPos16--oMC-G text--_fontBase--QdLsd",l="post_to_feed_view--searchFilterContainer--lyX72",i="post_to_feed_view--searchBar--IwmvI",r="post_to_feed_view--searchIcon---WXsZ",d="post_to_feed_view--caretIcon--akCZQ",s="post_to_feed_view--pageMenuDropdown--bS4RV",c="post_to_feed_view--scrollContainer--syalR",_="post_to_feed_view--innerScrollContainer--aP8K2",m="post_to_feed_view--loadingSpinnerContainer--E8n20",f="post_to_feed_view--pageSection--85j7J",u="post_to_feed_view--pageHeader--ZOfTF",p="post_to_feed_view--pageHeaderFaint--p-zwO",g="post_to_feed_view--tilesGrid--Ft03l",C="post_to_feed_view--tile--9a4ta",E="post_to_feed_view--selectedTile--D6T9A post_to_feed_view--tile--9a4ta",y="post_to_feed_view--tileThumbnail--FkrR9",b="post_to_feed_view--tileOverlay--iyl2x",h="post_to_feed_view--tileDetails--FZrxQ",I="post_to_feed_view--nodeName--jbJro",k="post_to_feed_view--thumbnail--uAumv",v="post_to_feed_view--notFoundContainer--5cMl3 text--fontPos16--oMC-G text--_fontBase--QdLsd",w="post_to_feed_view--searchQuery--TIyhI"},611928:(e,t,o)=>{o.d(t,{CQ:()=>i,DA:()=>b,Fd:()=>_,KG:()=>h,RO:()=>p,UD:()=>d,YI:()=>m,_5:()=>k,_f:()=>r,aF:()=>s,ku:()=>C,lt:()=>E,pb:()=>f,q3:()=>y,w8:()=>n,wg:()=>I,xe:()=>l,y3:()=>a,yD:()=>c,zE:()=>g,zb:()=>u});let a="create_feed_post_modal--avatarFloat--iIveN",n="create_feed_post_modal--addBorder--ioWGk",l="create_feed_post_modal--contentContainerV2--QwkuY",i="create_feed_post_modal--buttonRowV3--5nAjk modal--buttonRow--o2A0S",r="create_feed_post_modal--buttonRowLeft--TRB9A",d="create_feed_post_modal--buttonContainer--eO4q8",s="create_feed_post_modal--inputSectionMinimized--bq7wz create_feed_post_modal--inputSection--7p1jN",c="create_feed_post_modal--inputFields--bFFV7",_="create_feed_post_modal--draftText--n3VG5",m="create_feed_post_modal--postLoadingSpinner--rky-A",f="create_feed_post_modal--postButton--kaBoj",u="create_feed_post_modal--postingButton--VH5JE create_feed_post_modal--postButton--kaBoj",p="create_feed_post_modal--modalWrapper--4Bi1n",g="create_feed_post_modal--modalWrapperMinimized--syjBM create_feed_post_modal--modalWrapper--4Bi1n",C="create_feed_post_modal--contentNonEmpty--vTrJ6",E="create_feed_post_modal--contentWrapperMinimizedV2--Y56bB create_feed_post_modal--contentWrapperV2--CuYTA",y="create_feed_post_modal--contentWrapperV3--bCplT create_feed_post_modal--contentWrapperV2--CuYTA",b="create_feed_post_modal--descriptionWrapperV3--KrwNd",h="create_feed_post_modal--avatarAndDescriptionWrapperMinimized--yrvzI create_feed_post_modal--avatarAndDescriptionWrapper--JTvU3",I="create_feed_post_modal--minimizedButtonContainerV2--ZJZV- create_feed_post_modal--minimizedButtonContainer--fxgaf",k="create_feed_post_modal--loadingWrapper--mesOB"},699321:(e,t,o)=>{o.r(t),o.d(t,{CreateFeedPostContent:()=>j,CreateFeedPostModal:()=>G,getUploadErrorMessage:()=>q});var a=o(848318),n=o(716544),l=o(445777),i=o(157907),r=o(23459),d=o(536384),s=o.n(d),c=o(579020),_=o(193324),m=o(397579),f=o(857188),u=o(303035),p=o(427193),g=o(507152),C=o(757033),E=o(63571),y=o(145015),b=o(473889),h=o(280198),I=o(442313),k=o(697714),v=o(576220),w=o(110979),F=o(449737),S=o(87089),x=o(661780),N=o(825749),T=o(707717),M=o(850898),D=o(877297),P=o(438626),A=o(823888),B=o(318342),K=o(810968),L=o(295787),O=o(801092),R=o(583518),z=o(582538),W=o(853807),V=o(123714),Z=o(89394),U=o(494874),Q=o(611928);let X=[B.My.CONTEXT_MENU,B.My.SHARE];function q(e){switch(e.type){case M.Wn.MAX_UPLOADS_EXCEEDED:return(0,I.t)("fig_feed.too_many_content_items",e.params);case M.Wn.MAX_VIDEO_SIZE_EXCEEDED:return(0,I.t)("fig_feed.video_file_size_limit_MB",e.params);case M.Wn.MAX_IMAGE_SIZE_EXCEEDED:return(0,I.t)("fig_feed.image_file_size_limit_MB",e.params);case M.Wn.INVALID_FILE_TYPE:return(0,I.t)("fig_feed.unsupported_file_types_were_not_uploaded");case M.Wn.DUPLICATE_FILE_UPLOAD:return(0,I.t)("fig_feed.already_uploaded_items",e.params);case M.Wn.FAILED_TO_UPLOAD:return(0,I.t)("fig_feed.error_on_feed_post_creation");default:(0,l.xb)(e)}}function G(e){let t=(0,n.wA)(),o=(0,S.sZ)(),l=(0,P.R)(),i=a.useCallback(()=>{t(F.Ce())},[t]),r=(o?.name&&(0,I.tx)("fig_feed.post_to_org_feed",{orgName:o.name}))??(0,I.tx)("fig_feed.post_to_feed");return a.createElement(V.j,{title:r,onClose:()=>l(i)},a.createElement(j,{nodeInfo:e.nodeInfo,uploadInfo:e.uploadInfo,prototypeInfo:e.prototypeInfo,pageBackgroundColor:e.pageBackgroundColor,onSubmitSuccess:e.onSubmitSuccess,entryPoint:e.entryPoint,lockedFileKey:e.lockedFileKey}))}function j(e){let t=(0,n.wA)(),o=(0,S.sZ)(),l=(0,x.iZ)(),[d,G]=(0,r.fp)(P.T),[j,J]=a.useState(!1),[Y,$]=a.useState(!0),[H,ee]=a.useState(!1),[et,eo]=a.useState(!1),[ea,en]=a.useState((0,I.t)("fig_feed.title_input_placeholder")),[el,ei]=a.useState(e.nodeInfo??null),er=e.setMinimized,ed=a.useCallback(e=>{er&&er(e)},[er]),es=(0,n.d4)(e=>e.modalShown),[ec,e_]=a.useState((0,g.g)()),[em,ef]=a.useState(0),eu=a.useCallback(()=>{eM(""),eP([]),ed(!0),ee(!1),eh([]),e_((0,g.g)()),ef(0),ei(null)},[ed]),ep=a.useCallback(()=>{t((0,F.to)({type:Z.h,data:{onConfirm:eu},showModalsBeneath:!0}))},[t,eu]),eg=()=>{en(D.ZP[Math.floor(Math.random()*D.ZP.length)]())};a.useEffect(()=>{eg()},[]);let eC=e.pageBackgroundColor,eE=el?.fileKey??e.prototypeInfo?.fileKey??"";a.useEffect(()=>{let t={entryPoint:e.entryPoint};eE&&(t.fileKey=eE),(0,c.sx)("Team Feed Create Post Modal Opened",t)},[e.entryPoint,eE]);let ey=a.useCallback((e,a)=>{if(a){t(F.Ce());return}let n={text:(0,I.t)("fig_feed.view_post"),action:()=>{t(w.V3({url:(0,A.Kc)(o.id,{uuid:e})}))}};t(k.F.enqueue({message:(0,I.t)("fig_feed.posted_to_org_feed",{orgName:o.name}),button:n})),t(F.Ce())},[t,o]),[eb,eh]=a.useState([]),eI=a.useMemo(()=>new Set(eb.map(e=>e.displayContentItem.type===D.cM.NODE?e.displayContentItem.nodeId:null).filter(e=>null!==e)),[eb]);a.useEffect(()=>{(0,L.sr)(el,eI,eh,o?.id,eC)},[el,eI,eh,o?.id,eC]);let ek=a.useRef(null);a.useEffect(()=>{let t=e.prototypeInfo;if(!o?.id||!t||ek.current)return;let a=(0,K.WI)(t,o.id);ek.current=a.displayContentItem,eh(e=>[...e.filter(e=>e.displayContentItem.type!==D.cM.PROTOTYPE),a])},[o?.id,e.prototypeInfo]);let ev=a.useCallback(e=>{let t=(0,z.K1)(eb[em].displayContentItem);ef(e.findIndex(e=>(0,z.K1)(e)===t));let o=[];e.forEach(e=>{let t=(0,z.K1)(e),a=eb.find(e=>(0,z.K1)(e.displayContentItem)===t);a?o.push(a):console.error("Expected to have a matchedPendingItem")}),eh(o)},[eb,em]),ew=a.useCallback(e=>{ef(eb.findIndex(t=>(0,z.K1)(t.displayContentItem)===e))},[eb]),{setContentPreview:eF,snapshotStates:eS}=(0,L.eh)(eb,eh),{onSubmitSuccess:ex}=e,eN=a.useCallback((o,a)=>{C.Ay.post("/api/feed_posts",o).then(o=>{X.includes(e.entryPoint)?ey(o.data.meta.public_uuid,a):(eu(),eg()),a&&t(k.F.enqueue({message:(0,I.t)("fig_feed.post_submission_pending")})),ex&&ex(a)}).catch(()=>{t(h.s.error((0,I.t)("fig_feed.error_on_feed_post_creation"))),$(!1)})},[t,ey,ex,eu,e.entryPoint]),[eT,eM]=a.useState(""),[eD,eP]=a.useState([]),eA=a.useMemo(()=>({library:new T.M8(o.id)}),[o]);a.useEffect(()=>{$(eT.trim().length>R.Y||(0,_._Z)(eD).length>R.e||0===eb.length)},[eT,eD,eb.length]),a.useEffect(()=>{let e=eT.trim().length>0||!(0,_.I)(eD);J(e||eb.length>0),G(e)},[eD,G,eT,eb.length]);let eB=e.lockedFileKey||el?.fileKey,eK=async a=>{let n=new p.M4;if(n.start(),(0,c.sx)("team_feed_onsubmit",{currentOrgPresent:!!o,submitDisabled:Y},{logFromProber:!0}),!o||Y)return;a?.preventDefault(),$(!0);let l={description_meta:eD,org_id:o.id};l.background_color=eC;let i=(0,_._Z)(eD);l.content=await (0,K.pj)(t,eb,eE,eT),(0,c.sx)("team_feed_content_awaited",{payloadContent:JSON.stringify(l.content)},{logFromProber:!0});let r=l.content.some(e=>e.pending);l.uuid=ec,eT?l.title=eT:l.title=i.length>0?i.slice(0,40)+"\u2026":(0,I.t)("fig_feed.untitled_post"),eB&&(l.attached_file_key=eB),eN(l,r),n.stop(),(0,c.sx)("team_feed_click_to_post_latency",{elapsedTimeMs:n.getElapsedTime()},{forwardToDatadog:!0}),(0,c.sx)("Team Feed New Post Submitted",{fileKey:eE,entryPoint:e.entryPoint,text:i,numContentItems:l.content.length,contentItemTypes:l.content.map(e=>e.type)},{forwardToDatadog:!0})},eL=a.useCallback((e,a)=>{if(!o)return;let n=Array.from(e);if(0===n.length)return;let l=(0,N.KT)(n,eb.length,D.e3,D.bB,e=>{t(k.F.enqueue({message:q(e)}))},eb.map(e=>e.fileIdentifier)).map(e=>{let t=(0,N.Fn)(e);if(M.xp.includes(e.type))return(0,K.zr)(t,e);if(M.VY.includes(e.type))return(0,K.X2)(t,ec,o.id,e);throw Error("unexpected file type")}),i=void 0!==a?a:eb.length;eh(e=>[...e.slice(0,i),...l,...e.slice(i)]),ef(i)},[t,o,ec,eb]),eO=a.useCallback((e,t)=>()=>{let o=e.current?.files||null;null!==o&&0!==o.length&&(eL(o,t),ed(!1),e.current&&(e.current.value=""))},[eL,ed]),eR=(0,m.ZC)(e.uploadInfo);a.useEffect(()=>{e.uploadInfo&&e.uploadInfo!==eR&&(ed(!1),eL(e.uploadInfo))},[e.uploadInfo,eR,ed,eL]);let ez=a.useCallback(e=>{let t=Math.min(e,Math.max(0,eb.length-2)),o=eb[e];if((0,K.AK)(o),eh(t=>t.filter((t,o)=>o!==e)),o.displayContentItem.type===D.cM.NODE){let e=o.displayContentItem.nodeId;ei(t=>{if(t){let o=t.nodeIds.filter(t=>t!==e),a=t.nodeThumbnails,n=a&&o.reduce((e,t)=>(e[t]=a[t],e),{});return{...t,nodeIds:o,nodeThumbnails:n}}return null})}ef(t)},[eb]),eW=a.useCallback((e,t)=>{eL(e.files,t),eo(!1)},[eL]),eV=a.useRef(null),eZ=!!el?.nodeIds?.length,{openPostFromFileModal:eU,attachedFileData:eQ}=(0,L.Ld)({setLinkedFileNodeInfo:ei,numUserContentItems:eb.length,hasNodeContent:eZ,parentModalRef:eV,attachedFileKey:eB,lockedFileKey:e.lockedFileKey,currentOrgId:o?.id}),eX=a.useCallback(()=>{let e=eb.map(e=>e.displayContentItem);return a.createElement(E.Y,{className:s()(Q.xe,et&&Q.w8),isDragTarget:()=>!0,onTargetDragEnter:()=>eo(!0),onTargetDragLeave:()=>eo(!1),onTargetDrop:e=>eW(e)},a.createElement(z.Zo,{attachedFile:eQ,contentItems:e,deleteItemAtIdx:H?void 0:ez,dragging:et,mode:"create",onFileInputChange:eO,onReorderCallback:H?void 0:ev,openPostFromFileModal:eU,pageBackgroundColor:eC,scrollable:!1,selectedIdx:em,setContentPreview:eF,setSelectedContent:ew,setSelectedIdx:ef,shouldScrollToIndex:null,snapshotStates:eS,staticContent:!0}))},[eC,et,ev,ez,H,eb,eW,em,eO,ew,eS,eF,eU,eQ]),eq=a.useCallback(e=>{e.keyCode===f.Uz.ESCAPE&&ed(!0)},[ed]),eG=a.useCallback(()=>{es||(j&&(eM(e=>e.trim()),(0,_.I)(eD)&&eP([])),ed(!0))},[eD,ed,es,j]),ej=a.useCallback(()=>{eG(),t(F.Ce())},[t,eG]),eJ=a.createElement("div",{className:s()(Q.zE,d&&Q.ku),onKeyDown:e.disabled?u.lQ:eq,role:"textbox",tabIndex:0,onClick:()=>!e.disabled&&ed(!1)},l&&a.createElement("div",{className:Q.y3},a.createElement(W.A,{user:l,size:v.Pf.LARGE})),a.createElement("div",{className:Q.lt},a.createElement("div",{className:Q.KG},a.createElement("div",{className:Q.aF},a.createElement("div",{className:Q.yD},eT||ea," ",eT&&a.createElement("span",{className:Q.Fd},(0,I.t)("fig_feed.draft")))),a.createElement("div",{className:Q.wg},a.createElement(y.$$,{disabled:!0,dataTestId:"feed-post-post"},(0,I.tx)("fig_feed.post")))))),eY=a.createElement("div",{className:Q.RO,onKeyDown:eq,role:"textbox",tabIndex:0,onClick:()=>ed(!1),ref:eV},a.createElement("div",{className:Q.q3},eX(),o&&l?a.createElement("div",{className:Q.DA},a.createElement(O.FeedPostUnifiedComposer,{autofocus:!0,canUnlinkFile:!eZ&&!e.lockedFileKey,currentOrgId:o.id,description:eD,displayDecoratorsDownwards:!0,editableTypeaheadClass:U.up,fileData:eQ,hideSubmitButton:!0,lockFileAddition:eb.length>=D.e3,mentionables:eA,minimized:e.minimized,onSubmit:Y?void 0:eK,openPostFromFileModal:()=>eU({skipFrameSelection:!eZ}),parentRef:eV,readOnly:H,submitOnEnter:!1,title:eT,unlinkFile:()=>ei(null),updateDescription:eP,updateTitle:eM,user:l})):null),a.createElement("div",{className:Q.CQ},a.createElement("div",{className:Q.UD},!X.includes(e.entryPoint)&&(j?a.createElement(y.nR,{onClick:e=>{e.stopPropagation(),ep()}},(0,I.tx)("fig_feed.discard_draft")):a.createElement(y.nR,{onClick:e=>{e.stopPropagation(),eu()}},(0,I.tx)("general.cancel"))),a.createElement(y.$$,{onClick:e=>{if(!H)return ee(!0),eK(e).finally(()=>{ee(!1)})},disabled:Y,dataTestId:"feed-post-post",className:H?Q.zb:Q.pb},H&&a.createElement("div",{className:Q.YI},a.createElement(b.kt,{shouldMatchTextColor:!0,size:"medium"})),H?(0,I.tx)("fig_feed.posting"):(0,I.tx)("fig_feed.post"))))),e$=(o?.name&&(0,I.tx)("fig_feed.post_to_org_feed",{orgName:o.name}))??(0,I.tx)("fig_feed.post_to_feed");return o&&l&&(0,i.k)().xr_debounce_threshold?e.entryPoint===B.My.FEED_HEADER?a.createElement(a.Fragment,null,eJ,!e.minimized&&a.createElement(V.j,{title:e$,onClose:ej},eY)):eY:null}},123714:(e,t,o)=>{o.d(t,{j:()=>r});var a=o(848318),n=o(197933),l=o(314272),i=o(243023);function r(e){return a.createElement(n.i,{displayAs:n.C.Block},a.createElement(l.XV,{title:a.createElement("div",{className:"feed_modal_base--title--HN9jR"},e.title),maxWidth:i.b,minWidth:i.X,fixedTop:!1,onClose:e.onClose,headerClassName:"feed_modal_base--header--gAhz4",closeOnEsc:!0},e.children))}},295787:(e,t,o)=>{o.d(t,{sr:()=>Z,eh:()=>Q,Ld:()=>U});var a=o(848318),n=o(891627),l=o(716544),i=o(980399),r=o(442313),d=o(697714),s=o(449737),c=o(927813),_=o(997894),m=o(877297),f=o(810968),u=o(582538),p=o(445777),g=o(430285),C=o(536384),E=o.n(C),y=o(666428),b=o(922976),h=o(303035),I=o(266163),k=o(473889),v=o(575492),w=o(661780),F=o(918105),S=o(503024),x=o(464012),N=o(962465),T=o(561932),M=o(246633),D=o(314272),P=o(808123);let A="post_from_file_modal--grid--JdmAi",B="post_from_file_modal--searchLoadingSpinnerContainer---qSgU post_from_file_modal--loadingSpinnerContainer--QaXkG";var K=o(564422);let L=`https://${window.location.host}`;var O=(e=>(e[e.SELECT_FILE=1]="SELECT_FILE",e[e.SELECT_NODE=2]="SELECT_NODE",e))(O||{});function R(e){let t=a.useRef(null),o=(0,w.TA)(),n=encodeURIComponent(`${e.selectedFile.url}?fuid=${o}&post-to-feed=1&force-incremental=0`),l=`${L}/embed?integration_host=fig-feed&url=${n}`,[i,d]=a.useState(!1),[s,c]=a.useState([]);a.useEffect(()=>{let e=e=>{if(window.parent.origin!==e.origin)return;let{type:t,data:o}=e.data;t===T.v.LOADED&&d(()=>!0),t===T.v.SELECT_NODE&&c(()=>o??[])};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]);let _=s.length>0;return a.createElement(a.Fragment,null,!i&&a.createElement("div",{className:"post_from_file_modal--embedLoadingSpinnerContainer--x0E-V post_from_file_modal--loadingSpinnerContainer--QaXkG"},a.createElement(k.kt,{size:"large"})),a.createElement("iframe",{ref:t,className:"post_from_file_modal--iframe--W8QSR",title:"Figma",src:l,scrolling:"no"}),a.createElement("div",{className:"post_from_file_modal--footer--UhneR"},a.createElement(I.$$,{onClick:t=>{t.stopPropagation(),e.setNodeInfo({fileKey:e.selectedFile.key,nodeIds:s.map(e=>e.guid),nodeThumbnails:s.reduce((e,{guid:t,thumbnail:o})=>{let a=new Blob([o]),n=URL.createObjectURL(a);return{...e,[t]:n}},{}),backgroundColorByNode:s.reduce((e,{guid:t,backgroundColor:o})=>o?{...e,[t]:o}:e,{})}),e.hideModal?.()},disabled:!_},(0,r.tx)("fig_feed.add_to_post"))))}function z(e){let t=(0,y.ql)(e.orgId),o=g.Qw.useTransformShallowEqual(t,e=>e.filter(e=>e.can_edit)),n="loaded"===o.status,{setSelectedFile:l,onAfterSelect:i}=e,d=a.useCallback(e=>{l(e),i()},[l,i]),[s,c]=a.useState(""),[_,m]=a.useState(null),f=a.useMemo(()=>_?.map(e=>e.model.key)??[],[_]),u=(0,b.IT)(f),p=a.useMemo(()=>null===_?null:"loaded"===u.status?_.filter(e=>u.data[e.model.key]?.canEdit):null,[u,_]),C=a.useCallback(e=>a.createElement("div",{className:"post_from_file_modal--tileContainer--f1mpx",onClick:()=>{d(e)},role:"button",tabIndex:0,key:`tile-${e.key}`},a.createElement("div",{className:"post_from_file_modal--chooseFile--3ABxf"},(0,r.t)("fig_feed.choose_file")),a.createElement(P.GQ,{file:e,currentUser:null,activeFileUsers:[],subtitle:a.createElement(P.lJ,{file:e}),onClick:h.lQ})),[d]),E=a.useMemo(()=>s?p?0===p.length?a.createElement("div",{className:"post_from_file_modal--notFoundContainer--JLJWT text--fontPos16--oMC-G text--_fontBase--QdLsd"},a.createElement("div",null,(0,r.tx)("community.universal_posting_modal.recent_editable_files_search.no_files_matching",{searchQuery:a.createElement(a.Fragment,null,a.createElement("span",{className:"post_from_file_modal--searchQuery--GpUQJ"},s))}))):a.createElement(v.P,{hideScrollbar:!0},a.createElement("div",{className:A},p.map(e=>C(e.model)))):a.createElement("div",{className:B},a.createElement(k.kt,{size:"large"})):o.data&&a.createElement(v.P,{hideScrollbar:!0},a.createElement("div",{className:A},o.data.map(e=>C(e)))),[o.data,p,s,C]),I=a.useCallback(e=>{m(e.map(e=>({...e,model:{...F.F.toSinatra(e.model),fileRepo:e.model.fileRepo,fragments:e.model.fragments,owner:e.model.owner}})))},[m]);return n?a.createElement(a.Fragment,null,a.createElement("div",{className:"post_from_file_modal--searchContainer--oiMYX"},a.createElement(N.IW,{query:s,setQuery:c,setSearchResults:I,placeholderText:(0,r.t)("fig_feed.search_files")})),E):a.createElement("div",{className:B},a.createElement(k.kt,{size:"large"}))}function W(e){let{setModalPage:t,orgId:o,setSelectedFile:n}=e;return a.createElement(z,{orgId:o,setSelectedFile:n,onAfterSelect:e.skipFrameSelection?e.hideModal:()=>{t?.(2)}})}let V=(0,x.Ju)(function(e){let t=(0,l.wA)(),o=()=>{t(s.Lo()),e.parentRef?.current?.focus()},[n,i]=a.useState(e.attachedFile),[d,c]=a.useState(e.lockFileSelection||e.attachedFile?2:1),{setFeedPostNodeInfo:_}=e,m=a.useCallback(e=>{i(e),_({fileKey:e.key,nodeIds:[]})},[_]),f=e=>c(()=>e);return a.createElement(D.XV,{title:(()=>{switch(d){case 1:return(0,r.t)("fig_feed.choose_a_file");case 2:return a.createElement("div",{className:E()("post_from_file_modal--leftButtonGroup--ZT4p5",e.lockFileSelection&&"post_from_file_modal--headerPadding--6G68d")},!e.lockFileSelection&&a.createElement(M.K0,{svg:K.A,onClick:()=>f(1),"data-tooltip":(0,r.t)("fig_feed.button.back"),"data-tooltip-type":S.Ib.TEXT})," ",n?.name??"");default:(0,p.xb)(d)}})(),onClose:o,containerClassName:"post_from_file_modal--modalView--qMQ2p",innerContainerClassName:"post_from_file_modal--innerModalView--CfMj1",disableClickOutsideToHide:!0,maxWidth:1===d?1024:680,closeOnEsc:!0},(()=>{switch(d){case 1:return a.createElement(W,{orgId:e.orgId,setModalPage:f,setSelectedFile:m,hideModal:o,skipFrameSelection:e.skipFrameSelection});case 2:if(!n)return null;return a.createElement(R,{selectedFile:n,hideModal:o,setNodeInfo:e.setFeedPostNodeInfo});default:(0,p.xb)(d)}})())},"PostFromFileModal");function Z(e,t,o,a,l){if(!a||!e)return;let i=e.nodeIds.filter(e=>!t.has(e));0!==i.length&&(queueMicrotask(()=>{(0,n.flushSync)(()=>{o(t=>[...t,...(0,f.Px)(e.fileKey,i,a)])})}),(0,f.Rl)(e.fileKey,i,a,l,e.nodeThumbnails,e.backgroundColorByNode).then(e=>{o(t=>t.map(t=>t.displayContentItem.type===m.cM.NODE&&t.displayContentItem.isLoading?e[t.displayContentItem.nodeId]:t))}))}function U(e){let{setLinkedFileNodeInfo:t,numUserContentItems:o,hasNodeContent:n,parentModalRef:i,attachedFileKey:c,lockedFileKey:f,currentOrgId:u}=e,p=(0,l.wA)(),g=_.M4.useFile(c).data,C=a.useCallback(e=>{if(!f||e.fileKey===f){if(e.nodeIds.length+o>m.e3){p(d.F.enqueue({message:(0,r.t)("fig_feed.too_many_content_items",{maxNum:m.e3})}));return}t(t=>{let o=e.nodeIds,a=e.nodeThumbnails,n=e.backgroundColorByNode;return t&&e.fileKey===t.fileKey?{fileKey:t.fileKey,nodeIds:[...new Set(t.nodeIds.concat(o))],nodeThumbnails:{...t.nodeThumbnails,...a},backgroundColorByNode:{...t.backgroundColorByNode,...n}}:{fileKey:e.fileKey,nodeIds:o,nodeThumbnails:a,backgroundColorByNode:n}})}},[p,o,f,t]);return{openPostFromFileModal:a.useCallback(e=>{u&&p((0,s.to)({type:V,data:{orgId:u,setFeedPostNodeInfo:C,attachedFile:g,parentRef:i,lockFileSelection:f||g&&n,skipFrameSelection:e?.skipFrameSelection}}))},[p,u,C,g,f,n,i]),attachedFileData:g}}function Q(e,t){return{setContentPreview:a.useCallback((o,a,n)=>{let l=Array.from(e),r=l.findIndex(e=>(0,u.K1)(e.displayContentItem)===o),d=l[r];if(d&&(0,m.aT)(d.displayContentItem)){d.preview={url:a,state:n};let e=d.displayContentItem;e.preview_image_url=a,e.backgroundColor=(0,i.colorToHex)(n.backgroundColor),t(l)}else console.error("expected to find matched content item")},[e,t]),snapshotStates:a.useMemo(()=>e.reduce((e,t)=>(t.preview?e[(0,u.K1)(t.displayContentItem)]=t.preview.state:(0,f.EU)(t.displayContentItem)&&(e[(0,u.K1)(t.displayContentItem)]={x:t.displayContentItem.initialX,y:t.displayContentItem.initialY,zoom:t.displayContentItem.initialZoom,ratio:1,backgroundColor:(0,c.dy)(t.displayContentItem.backgroundColor)}),e),{}),[e])}}}}]);

//# debugId=ba567ef6-a672-5445-b5c5-cb6951b031aa

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/2df57f875f44363f8171c56ac5d972737e38e75d/9890-74d6c217d8bf9eaf.min.js.map